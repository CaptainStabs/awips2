<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/Organization">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1">
<meta name="google-site-verification" content="k0e8DrbD40s54xHNBqwIsRrSSAkZoprwtEYDnNY06bU" />
<meta name="google-site-verification" content="pnjjbQFvjPwaWhEXY6nSyaS9iyghmH-M_yLHBveDX2M">
<meta itemprop="name" content="AWIPS User Manual - EDEX Data Purging">
<meta itemprop="description" content="Polymer is a library that uses the latest web technologies to let you create custom HTML elements. Build anything from a button to a complete application as an encapsulated, reusable element that works across desktop and mobile.">


<meta itemprop="image" content="https://www.polymer-project.org/images/instacod.png">


<title>
  
    EDEX Data Purging -
   AWIPS User Manual
</title>
<link rel="publisher" href="https://plus.google.com/107187849809354688692">
<link rel="shortcut icon" href="http://www.unidata.ucar.edu/favicon.ico">
<link href="//fonts.googleapis.com/css?family=RobotoDraft:300,400,500|Source+Code+Pro:400,500,700" rel="stylesheet">
<link href="/awips2/css/site2.css?20160929" rel="stylesheet">
<link href="/awips2/css/site2_sd_rules.css?20160929" rel="stylesheet" shim-shadowdom>



<script src="/awips2/components/webcomponentsjs/webcomponents.min.js?20160929"></script>
<!-- TODO: remove when https://github.com/Polymer/polymer/issues/391 is fixed -->
<link rel="import" href="/awips2/components/polymer/polymer.html">
<link rel="stylesheet" href="/awips2/css/elements/docs-menu.css">
<link rel="import" href="/awips2/elements/common_elements.vulcanized.html?20160929">


</head>
<body id="edex-data-purging">

<main id="content-container" class="polymer-content">
  <app-drawer id="sidebar" unresolved>
    <div layout vertical id="sidebar-content">
      <div id="logo-container" layout horizontal center>
        <a href="/awips2/" class="logo"><img src="/awips2/images/logos/awips2.png" alt="Unidata AWIPS User Guide"></a>
      </div>

      <docs-menu unresolved flex
		 baseurl='/awips2'
                 coreElements='{"core-header-panel":"components/core-header-panel/core-header-panel.html","core-transition-pages":"components/core-animated-pages/transitions/core-transition-pages.html","core-animated-pages":"components/core-animated-pages/core-animated-pages.html","core-overlay":"components/core-overlay/core-overlay.html","core-toolbar":"components/core-toolbar/core-toolbar.html","core-image":"components/core-image/core-image.html","core-shared-lib":"components/core-shared-lib/core-shared-lib.html","core-a11y-keys":"components/core-a11y-keys/core-a11y-keys.html","core-menu-button":"components/core-menu-button/core-menu-button.html","core-icon":"components/core-icon/core-icon.html","core-selection":"components/core-selection/core-selection.html","core-style":"components/core-style/core-style.html","core-menu":"components/core-menu/core-menu.html","core-submenu":"components/core-menu/core-submenu.html","core-list":"components/core-list/core-list.html","core-dropdown-menu":"components/core-dropdown-menu/core-dropdown-menu.html","core-input":"components/core-input/core-input.html","core-iconset-svg":"components/core-iconset-svg/core-iconset-svg.html","core-field":"components/core-field/core-field.html","core-selector":"components/core-selector/core-selector.html","core-media-query":"components/core-media-query/core-media-query.html","core-animation-group":"components/core-animation/core-animation-group.html","core-animation":"components/core-animation/core-animation.html","core-animation-keyframe":"components/core-animation/core-animation.html","core-animation-prop":"components/core-animation/core-animation.html","core-dropdown":"components/core-dropdown/core-dropdown.html","core-dropdown-base":"components/core-dropdown/core-dropdown-base.html","core-pages":"components/core-pages/core-pages.html","core-meta":"components/core-meta/core-meta.html","core-splitter":"components/core-splitter/core-splitter.html","core-scroll-header-panel":"components/core-scroll-header-panel/core-scroll-header-panel.html","core-tooltip":"components/core-tooltip/core-tooltip.html","core-localstorage":"components/core-localstorage/core-localstorage.html","core-scroll-threshold":"components/core-scroll-threshold/core-scroll-threshold.html","core-drag-drop":"components/core-drag-drop/core-drag-drop.html","core-iconset":"components/core-iconset/core-iconset.html","core-label":"components/core-label/core-label.html","core-signals":"components/core-signals/core-signals.html","core-transition":"components/core-transition/core-transition.html","core-scaffold":"components/core-scaffold/core-scaffold.html","core-drawer-panel":"components/core-drawer-panel/core-drawer-panel.html","core-range":"components/core-range/core-range.html","core-collapse":"components/core-collapse/core-collapse.html","core-xhr":"components/core-ajax/core-xhr.html","core-ajax":"components/core-ajax/core-ajax.html","core-icon-button":"components/core-icon-button/core-icon-button.html","core-item":"components/core-item/core-item.html"}'
                 paperElements='{"paper-dropdown":"components/paper-dropdown/paper-dropdown.html","paper-dropdown-transition":"components/paper-dropdown/paper-dropdown-transition.html","paper-item":"components/paper-item/paper-item.html","paper-dropdown-menu":"components/paper-dropdown-menu/paper-dropdown-menu.html","paper-checkbox":"components/paper-checkbox/paper-checkbox.html","paper-button":"components/paper-button/paper-button.html","paper-button-base":"components/paper-button/paper-button-base.html","paper-menu-button":"components/paper-menu-button/paper-menu-button.html","paper-radio-group":"components/paper-radio-group/paper-radio-group.html","paper-toast":"components/paper-toast/paper-toast.html","paper-char-counter":"components/paper-input/paper-char-counter.html","paper-autogrow-textarea":"components/paper-input/paper-autogrow-textarea.html","paper-input":"components/paper-input/paper-input.html","paper-input-decorator":"components/paper-input/paper-input-decorator.html","paper-slider":"components/paper-slider/paper-slider.html","paper-toggle-button":"components/paper-toggle-button/paper-toggle-button.html","paper-fab":"components/paper-fab/paper-fab.html","paper-ripple":"components/paper-ripple/paper-ripple.html","paper-icon-button":"components/paper-icon-button/paper-icon-button.html","paper-tabs":"components/paper-tabs/paper-tabs.html","paper-tab":"components/paper-tabs/paper-tab.html","paper-shadow":"components/paper-shadow/paper-shadow.html","paper-radio-button":"components/paper-radio-button/paper-radio-button.html","paper-dialog":"components/paper-dialog/paper-dialog.html","paper-action-dialog":"components/paper-dialog/paper-action-dialog.html","paper-dialog-base":"components/paper-dialog/paper-dialog-base.html","paper-dialog-transition":"components/paper-dialog/paper-dialog-transition.html","paper-spinner":"components/paper-spinner/paper-spinner.html","paper-progress":"components/paper-progress/paper-progress.html"}'></docs-menu>
    </div>
  </app-drawer>

  <scroll-area sidebar unresolved class="scrolling">
    <site-banner type="guide" shortname="Docs" unresolved>
      
<app-bar theme="light" class="bar fixed">
</app-bar>

      <header class="shrink">
        <h1>
         EDEX Data Purging
        </h1>
      </header>
    </site-banner>

    
    

    <article class="show-permalinks">

      <header class="onlyonmobile">
        <h1>
          : EDEX Data Purging
        </h1>
      </header>

      
<!--TOC_START-->
<ul id="markdown-toc">
  <li><a href="#time-base-purge" id="markdown-toc-time-base-purge">Time-base purge</a>    <ul>
      <li><a href="#day-nexrad3-archive" id="markdown-toc-day-nexrad3-archive">30-day NEXRAD3 archive</a></li>
    </ul>
  </li>
  <li><a href="#frame-based-purge" id="markdown-toc-frame-based-purge">Frame-based purge</a></li>
  <li><a href="#logging" id="markdown-toc-logging">Logging</a></li>
  <li><a href="#all-purge-rules" id="markdown-toc-all-purge-rules">All Purge Rules</a></li>
</ul>
<!--TOC_END-->

<p>AWIPS uses a plugin-based purge strategy for HDF5 data, allowing the user to change the purge frequency for each plugin individually, and specific products for a particular plugin.</p>

<blockquote>
  <p>Purge is triggered by a quartz timer event that fires at 30 minutes after each hour.</p>
</blockquote>

<p>Purging rules are defined in XML files in the Localization Store, accessible from the CAVE localization perspective. On EDEX, most are located in <code>/awips2/edex/data/utility/common_static/base/purge</code>, and follow the <strong>base/site</strong> localization pattern (e.g. site purge files are in <code>site/XXX/purge</code> rather than <code>base/purge</code>, where XXX is the site identifier.</p>

<h1 id="time-base-purge">Time-base purge</h1>

<p>If a plugin has no XML file, the default rule of 1 day (24 hours) is used, from <code>/awips2/edex/data/utility/common_static/base/purge/defaultPurgeRules.xml</code></p>

<pre><code>&lt;purgeRuleSet&gt;
    &lt;defaultRule&gt;
        &lt;period&gt;01-00:00:00&lt;/period&gt;
    &lt;/defaultRule&gt;
&lt;/purgeRuleSet&gt;
</code></pre>

<p>Time-based purging uses the <em>reference time</em> of the data, and dtermination of the reference time is decoder based.</p>

<blockquote>
  <h3 id="day-nexrad3-archive">30-day NEXRAD3 archive</h3>
  <p>Modify <code>/awips2/edex/data/utility/common_static/base/purge/radarPurgeRules.xml</code> to increase the data retention period from 7 to 31 days:</p>

  <pre><code>&lt;purgeRuleSet&gt;
        &lt;defaultRule&gt;
                &lt;period&gt;31-00:00:00&lt;/period&gt;
        &lt;/defaultRule&gt;
&lt;/purgeRuleSet&gt;
</code></pre>

  <p><strong>Note</strong>: you do NOT have to restart EDEX when you change a purge rule!</p>
</blockquote>

<h1 id="frame-based-purge">Frame-based purge</h1>

<p>Some plugins use frame-base purging, retaining and certain number of prpduct “versions”.</p>

<p><code>/awips2/edex/data/utility/common_static/base/purge/satellitePurgeRules.xml</code></p>

<pre><code>&lt;purgeRuleSet&gt;
    &lt;key&gt;sectorID&lt;/key&gt;
    &lt;key&gt;physicalElement&lt;/key&gt;
    &lt;defaultRule&gt;
            &lt;versionsToKeep&gt;196&lt;/versionsToKeep&gt;
    &lt;/defaultRule&gt;
    &lt;rule&gt;
            &lt;keyValue&gt;NEXRCOMP&lt;/keyValue&gt;
            &lt;versionsToKeep&gt;288&lt;/versionsToKeep&gt;
    &lt;/rule&gt;
    &lt;rule&gt;
            &lt;keyValue&gt;Alaska National&lt;/keyValue&gt;
            &lt;versionsToKeep&gt;48&lt;/versionsToKeep&gt;
    &lt;/rule&gt;
</code></pre>

<blockquote>
  <p>In the above example, notice a <em>default rule</em> (196) as well as specific sectors with their own rules.</p>
</blockquote>

<h1 id="logging">Logging</h1>

<p>Data purge events are logged to the file <code>edex-ingest-purge-&lt;yyyymmdd&gt;.log</code>, where <code>&lt;yyyymmdd&gt;</code> is the date stamp.</p>

<pre><code>tail -f edex-ingest-purge-20120327.log 

--------START LOG PURGE---------
INFO  2012-03-27 00:30:00,027 [DefaultQuartzScheduler_Worker-3] PurgeLogger: EDEX - PURGE LOGS::Skipped file with invalid fileName: afos-trigger.log
INFO  2012-03-27 00:30:00,193 [DefaultQuartzScheduler_Worker-3] PurgeLogger: EDEX - PURGE LOGS::Removed 1 old files
INFO  2012-03-27 00:31:23,155 [DefaultQuartzScheduler_Worker-3] PurgeLogger: EDEX - PURGE LOGS::Archived 14 files
INFO  2012-03-27 00:31:23,155 [DefaultQuartzScheduler_Worker-3] PurgeLogger: EDEX - PURGE LOGS::Skipped processing 1 files
INFO  2012-03-27 00:31:23,155 [DefaultQuartzScheduler_Worker-3] PurgeLogger: EDEX - PURGE LOGS::---------END LOG PURGE-----------
</code></pre>

<h1 id="all-purge-rules">All Purge Rules</h1>

<p>To see all purge rule directories (base, site, region, configured):</p>

<pre><code>find /awips2/edex/data/utility -name purge

/awips2/edex/data/utility/edex_static/region/CR/purge
/awips2/edex/data/utility/edex_static/base/purge
/awips2/edex/data/utility/edex_static/configured/OAX/purge
/awips2/edex/data/utility/edex_static/site/OAX/purge
/awips2/edex/data/utility/common_static/region/CR/purge
/awips2/edex/data/utility/common_static/base/purge
/awips2/edex/data/utility/common_static/configured/OAX/purge
/awips2/edex/data/utility/common_static/site/AFC/purge
/awips2/edex/data/utility/common_static/site/OAX/purge
</code></pre>

<p>To see a list of the data plug-ins that have purge rules:</p>

<pre><code>find /awips2/edex/data/utility -name "*PurgeRules.xml"

/awips2/edex/data/utility/edex_static/base/purge/airmetPurgeRules.xml
/awips2/edex/data/utility/edex_static/base/purge/convsigmetPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufruaPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/obsPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/nctextPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/ncscatPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/vaaPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrmosHPCPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrhdwPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/cwaPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/airmetPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/ffmpPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/lsrPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/profilerPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/poessoundingPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/gpdPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/mcidasPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/acarssoundingPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/ffgPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/sgwhvPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/intlsigmetPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/aggregatePurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/radarPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/idftPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/wcpPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/warningPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/satellitePurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/sshaPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/ldadhydroPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/ldadmesonetPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/ccfpPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/atcfPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrssmiPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/sgwhPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/geomagPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/modelsoundingPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrmosAVNPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/ncuairPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/acarsPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/airepPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrquikscatPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/cwatPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/nonconvsigmetPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/pirepPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/statsPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrmthdwPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrascatPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/gridPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrmosGFSPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/ncpafmPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrsigwxPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/pgenPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/dmwPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrmosMRFPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrmosETAPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/sfcobsPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/modisPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/awwPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/defaultPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/ldadprofilerPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrmosNGMPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/madisPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/convsigmetPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/redbookPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrncwfPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/tcmPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/bufrmosLAMPPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/goessoundingPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/binlightningPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/stormTrackPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/ghcdPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/ldadmanualPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/ntransPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/mosaicPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/regionalsatPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/nctafPurgeRules.xml
/awips2/edex/data/utility/common_static/base/purge/solarimagePurgeRules.xml
/awips2/edex/data/utility/common_static/site/AFC/purge/regionalsatPurgeRules.xml
</code></pre>

    </article>

    <footer>
  <div>
    <div class="links">
      <a href="https://www.facebook.com/unidata" title="Unidata on Facebook" tabindex="-1"><paper-button><core-icon icon="social:post-facebook"></core-icon>Facebook</paper-button></a>
      <a href="https://twitter.com/intent/follow?screen_name=unidata" data-twitter-follow title="Follow @Unidata on Twitter" tabindex="-1"><paper-button><core-icon icon="social:post-twitter"></core-icon>Twitter</paper-button></a>
      <a href="https://github.com/Unidata/awips2"><paper-button class="github" tabindex="-1"><core-icon icon="social:post-github"></core-icon>GitHub</paper-button></a>
      <a href="https://github.com/Unidata/awips2/issues/new" tabindex="-1"><paper-button><core-icon icon="bug-report"></core-icon>File a bug</paper-button></a>
    </div>

  </div>
</footer>





<script src="/awips2/js/prettify/prettify.js"></script>

<!-- <script src="/awips2/js/bower_components/smoothscroll/smoothscroll.js"></script> -->
<script src="/awips2/js/app.js?20160929"></script>


  </scroll-area>

</main>

</body>
</html>
